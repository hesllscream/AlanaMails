---
/**
 * Dynamic Landing Page for Prospects
 * Displays personalized content based on slug
 */
import { supabase, type Prospect } from '@/lib/supabase'
import BaseLayout from '@/layouts/BaseLayout.astro'
import HeroSection from '@/ui/components/organisms/Hero/Hero.astro'
import FeaturesSection from '@/ui/components/organisms/FeaturesSection/FeaturesSection.astro'
import AuditSection from '@/ui/components/organisms/AuditSection/AuditSection.astro'
import PricingSection from '@/ui/components/organisms/PricingSection/PricingSection.astro'
import SyndicateSection from '@/ui/components/organisms/SyndicateSection/SyndicateSection.astro'
import ZombieSection from '@/ui/components/organisms/ZombieSection/ZombieSection.astro'
import Footer from '@/ui/components/organisms/Footer/Footer.astro'

export const prerender = false

const { slug } = Astro.params

// Fetch prospect data from Supabase
const { data: prospect, error } = await supabase
  .from('prospects')
  .select('*')
  .eq('slug', slug)
  .single()

// If prospect not found, redirect to home
if (error || !prospect) {
  return Astro.redirect('/')
}

const name = prospect.name
const platform = prospect.platform
---

<BaseLayout title={`Propuesta para ${name} - Alana AI`}>
  <main>
    <HeroSection name={name} platform={platform} />
    <FeaturesSection />
    <AuditSection />
    <ZombieSection />
    <PricingSection />
    <SyndicateSection />
    <Footer name={name} />
  </main>
</BaseLayout>
